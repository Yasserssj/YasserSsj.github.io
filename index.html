<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>¬øPuedo seguir siendo tu novio?</title>
<style>
  :root{--pink:#ff5d8f;--green:#2ecc71;--red:#ff4b5c;--btnW:clamp(90px,20vw,160px);--gap:clamp(12px,4vw,28px)}
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Helvetica,Arial,sans-serif;background:#fff;color:#111}
  .wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;overflow:hidden;padding:24px}
  h1{font-size:clamp(28px,7vw,56px);margin:0 0 6px;text-align:center;font-weight:700}
  p.instr{font-size:clamp(12px,2.5vw,16px);color:#666;margin:0 0 22px;text-align:center}

  .drop{width:320px;max-width:86vw;height:120px;border-radius:14px;border:3px dashed rgba(0,0,0,0.1);display:flex;align-items:center;justify-content:center;position:relative;background:rgba(255,255,255,0.6);box-shadow:0 8px 30px rgba(0,0,0,0.05);z-index:2}
  .drop .label{font-weight:600;color:#333}

  .stage{position:relative;margin-top:18px;width:100%;display:flex;align-items:center;justify-content:center}
  .drag-wrap{position:relative;width:360px;max-width:90vw;height:160px}

  .btn{width:var(--btnW);height:var(--btnW);border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;touch-action:none;user-select:none;cursor:pointer;position:absolute;top:24px;z-index:3}
  .btn.green{background:linear-gradient(180deg,var(--green),#1fa65a);left:calc(50% - var(--gap)/2 - var(--btnW));}
  .btn.red{background:linear-gradient(180deg,var(--red),#e03a48);left:calc(50% + var(--gap)/2);}

  /* bot√≥n que aparece cuando arrastras correctamente */
  #confirmWA{
    display:none;
    margin-top:20px;
    background:#25d366;
    color:white;
    padding:14px 20px;
    border-radius:14px;
    font-size:18px;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,0.2);
    z-index:10;
  }
</style>
</head>

<body>
<div class="wrap">
  <h1>¬øPuedo seguir siendo tu novio?</h1>
  <p class="instr">arrastra la respuesta hacia el recuadro</p>

  <div class="drop" id="drop">
    <div class="label">Respuesta aqu√≠</div>
  </div>

  <div class="stage">
    <div class="drag-wrap" id="stage">
      <div class="btn green" id="yes">S√≠</div>
      <div class="btn red" id="no">No</div>
    </div>
  </div>

  <button id="confirmWA">Enviar respuesta por WhatsApp</button>
</div>

<script>
const yes = document.getElementById("yes");
const no = document.getElementById("no");
const drop = document.getElementById("drop");
const stage = document.getElementById("stage");
const confirmBtn = document.getElementById("confirmWA");

let active = null;
let start = {x:0,y:0};
let origin = new Map();

function setOrigin(el,l,t){ origin.set(el,{x:l,y:t}); }
function getOrigin(el){ return origin.get(el); }

function openWA(){
  const msg =
`Si amor podemos seguir siendo novios ‚ù§Ô∏èü•∫
Te amo much√≠simo üíï
Me comprometo a enviarte foto de mis pies en menos de 5 minutos üò≥üíñ`;

  const url = "https://wa.me/50557740879?text="+encodeURIComponent(msg);
  window.location.href = url;
}

// distancia
function isNear(el){
  const er=el.getBoundingClientRect(), dr=drop.getBoundingClientRect();
  const ex=er.left+er.width/2, ey=er.top+er.height/2;
  const dx=ex-(dr.left+dr.width/2), dy=ey-(dr.top+dr.height/2);
  return Math.hypot(dx,dy) < 120;
}

function bindDrag(el){
  el.addEventListener("pointerdown", e=>{
    e.preventDefault();
    el.setPointerCapture(e.pointerId);
    active = el;
    start.x=e.clientX; start.y=e.clientY;
    const o = getOrigin(el);
    el._sx=o.x; el._sy=o.y;
    el.style.transition="none";
  });
}

// mover
window.addEventListener("pointermove", e=>{
  if(!active) return;
  let dx=e.clientX-start.x, dy=e.clientY-start.y;
  active.style.left = (active._sx+dx)+"px";
  active.style.top  = (active._sy+dy)+"px";

  // cuando entra correctamente ‚Üí mostramos bot√≥n real
  if(active.id==="yes" && isNear(active)){
    confirmBtn.style.display="block";
    if(navigator.vibrate) navigator.vibrate(40);
  }
});

// soltar
window.addEventListener("pointerup", e=>{
  if(!active) return;
  const el=active;
  active=null;

  const moved=Math.hypot(e.clientX-start.x,e.clientY-start.y);

  if(el.id==="yes" && moved<10){
    openWA(); return;
  }

  if(el.id==="yes" && isNear(el)){
    // NO ABRIMOS WA AQU√ç (m√≥vil lo bloquea)
    // solo animamos y mostramos el bot√≥n
    confirmBtn.style.display="block";
    return;
  }

  revert(el);
});

function revert(el){
  const o=getOrigin(el);
  el.style.transition=".3s";
  el.style.left=o.x+"px";
  el.style.top=o.y+"px";
}

// bot√≥n real ‚Üí SIEMPRE funciona en m√≥vil
confirmBtn.onclick = openWA;

// recalcular
function recalc(){
  const s=stage.getBoundingClientRect();
  [yes,no].forEach(el=>{
    const r=el.getBoundingClientRect();
    let x=r.left-s.left, y=r.top-s.top;
    el.style.left=x+"px"; el.style.top=y+"px";
    setOrigin(el,x,y);
  });
}
window.addEventListener("load", recalc);
window.addEventListener("resize", recalc);

bindDrag(yes);
bindDrag(no);
</script>

</body>
</html>
