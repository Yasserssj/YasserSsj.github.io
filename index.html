<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>¿Puedo seguir siendo tu novio?</title>
  <style>
    :root{--pink:#ff5d8f;--green:#2ecc71;--red:#ff4b5c;--btnW:clamp(90px,20vw,160px);--gap:clamp(12px,4vw,28px)}
    html,body{height:100%;margin:0;font-family:Inter,Segoe UI,Helvetica,Arial,sans-serif;background:#fff;color:#111}
    .wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;overflow:hidden;padding:24px}
    h1{font-size:clamp(28px,7vw,56px);margin:0 0 6px;text-align:center;font-weight:700}
    p.instr{font-size:clamp(12px,2.5vw,16px);color:#666;margin:0 0 22px;text-align:center}

    .drop{width:320px;max-width:86vw;height:120px;border-radius:14px;border:3px dashed rgba(0,0,0,0.1);display:flex;align-items:center;justify-content:center;position:relative;background:rgba(255,255,255,0.6);box-shadow:0 8px 30px rgba(0,0,0,0.05);z-index:2}
    .drop .label{font-weight:600;color:#333}

    .stage{position:relative;margin-top:18px;width:100%;display:flex;align-items:center;justify-content:center}
    .drag-wrap{position:relative;width:360px;max-width:90vw;height:160px}

    .btn{width:var(--btnW);height:var(--btnW);border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;touch-action:none;user-select:none;cursor:pointer;position:absolute;top:24px;z-index:3}
    .btn.green{background:linear-gradient(180deg,var(--green),#1fa65a);left:calc(50% - var(--gap)/2 - var(--btnW));}
    .btn.red{background:linear-gradient(180deg,var(--red),#e03a48);left:calc(50% + var(--gap)/2);}

    .hearts{pointer-events:none;position:absolute;inset:0;overflow:hidden;z-index:0}
    .heart{position:absolute;width:var(--size,18px);height:var(--size,18px);transform:rotate(45deg);opacity:0.12;background:var(--pink)}
    .heart::before,.heart::after{content:"";position:absolute;width:var(--size,18px);height:var(--size,18px);border-radius:50%;background:var(--pink)}
    .heart::before{top:-50%;left:0}
    .heart::after{left:50%;top:0}

    @keyframes floaty{0%{transform:translateY(0) rotate(0) scale(0.9)}100%{transform:translateY(-140vh) rotate(360deg) scale(1.2)}}
    .pulse{animation:pulse 600ms ease both}
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.12)}100%{transform:scale(1)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hearts" aria-hidden="true"></div>
    <h1>¿Puedo seguir siendo tu novio?</h1>
    <p class="instr">arrastra la respuesta hacia el recuadro</p>

    <div class="drop" id="drop">
      <div class="label">Respuesta aquí</div>
    </div>

    <div class="stage">
      <div class="drag-wrap" id="stage">
        <div class="btn green" id="yes">Sí</div>
        <div class="btn red" id="no">No</div>
      </div>
    </div>
  </div>

<script>
const yes = document.getElementById("yes");
const no = document.getElementById("no");
const drop = document.getElementById("drop");
const stage = document.getElementById("stage");

let active = null;
let start = {x:0, y:0};
let origin = new Map();

function setOrigin(el){ 
  const r = el.getBoundingClientRect();
  const s = stage.getBoundingClientRect();
  el.style.left = (r.left - s.left) + "px";
  el.style.top = (r.top - s.top) + "px";
  origin.set(el,{x:r.left-s.left, y:r.top-s.top});
}
function getOrigin(el){ return origin.get(el); }

function isNearDrop(el){
  const er = el.getBoundingClientRect();
  const dr = drop.getBoundingClientRect();
  const ex = er.left + er.width/2;
  const ey = er.top + er.height/2;
  const dx = ex - (dr.left + dr.width/2);
  const dy = ey - (dr.top + dr.height/2);
  return Math.hypot(dx,dy) < 120;
}

function openWhatsAppDirect(){
  const phone = "50557740879";
  const msg = encodeURIComponent(
    "Si amor podemos seguir siendo novios.\n\nTe amo mucho.\n\nMe comprometo a enviarte foto de mis pies en menos de 5 minutos"
  );
  location.href = `https://wa.me/${phone}?text=${msg}`;
}

function bindDrag(el){
  el.addEventListener("pointerdown", e=>{
    active = el;
    start.x = e.clientX;
    start.y = e.clientY;
    const o = getOrigin(el);
    el._lx = o.x;
    el._ly = o.y;
    el.setPointerCapture(e.pointerId);
    el.style.transition = "none";
  });
}

window.addEventListener("pointermove", e=>{
  if(!active) return;
  const dx = e.clientX - start.x;
  const dy = e.clientY - start.y;
  active.style.left = (active._lx + dx) + "px";
  active.style.top = (active._ly + dy) + "px";
});

window.addEventListener("pointerup", e=>{
  if(!active) return;
  const el = active;
  active.releasePointerCapture(e.pointerId);
  active = null;

  const moved = Math.hypot(e.clientX - start.x, e.clientY - start.y);

  // CLIC EN ESCRITORIO
  if(el.id=="yes" && moved < 12){
    openWhatsAppDirect();
    return;
  }

  // SOLTADO EN EL RECUADRO
  if(isNearDrop(el)){
    if(el.id=="yes"){
      openWhatsAppDirect();
      return;
    }
  }

  // Revertir
  const o = getOrigin(el);
  el.style.transition = "all .3s";
  el.style.left = o.x+"px";
  el.style.top = o.y+"px";
});

/* ——— SUPER FIX PARA MÓVILES ——— */
yes.addEventListener("touchend", ()=>{
  if(isNearDrop(yes)){
    openWhatsAppDirect();
  }
});

/* bloquear arrastre fantasma */
["dragstart","touchstart"].forEach(ev=>{
  yes.addEventListener(ev, e=>e.preventDefault());
  no.addEventListener(ev, e=>e.preventDefault());
});

/* posiciones iniciales */
window.addEventListener("load", ()=>{
  setOrigin(yes);
  setOrigin(no);
});
window.addEventListener("resize", ()=>{
  setOrigin(yes);
  setOrigin(no);
});
bindDrag(yes);
bindDrag(no);
</script>

</body>
</html>


